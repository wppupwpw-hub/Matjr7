// netlify/functions/webhook.js

export async function handler(event, context) {
  const VERIFY_TOKEN = process.env.VERIFY_TOKEN;
  const PAGE_ACCESS_TOKEN = process.env.PAGE_ACCESS_TOKEN;

  // โ ุงูุชุญูู ูู ููุณุจูู
  if (event.httpMethod === "GET") {
    const params = event.queryStringParameters;
    if (params["hub.verify_token"] === VERIFY_TOKEN) {
      return {
        statusCode: 200,
        body: params["hub.challenge"],
      };
    }
    return { statusCode: 403, body: "Forbidden" };
  }

  // โ ุงูุชุนุงูู ูุน ุงูุฑุณุงุฆู ุงููุงุฑุฏุฉ
  if (event.httpMethod === "POST") {
    const body = JSON.parse(event.body);

    if (body.object === "page") {
      for (const entry of body.entry) {
        const webhookEvent = entry.messaging[0];
        const senderId = webhookEvent.sender.id;

        if (webhookEvent.message) {
          const userMsg = webhookEvent.message.text ? webhookEvent.message.text.trim() : '';
          console.log("๐ฉ ุฑุณุงูุฉ ุงููุณุชุฎุฏู:", userMsg);
          
          const botResponse = generateDynamicResponse(userMsg);
          await sendMessage(senderId, botResponse, PAGE_ACCESS_TOKEN);
          
        } else if (webhookEvent.postback && webhookEvent.postback.payload === "GET_STARTED_PAYLOAD") {
          const welcomeText = "ุฃููุงู ุจู! ุฃูุง ูุณุงุนุฏู ุงูุฐูู. ููููู ุณุคุงูู ุนู:\n\n๐ ุงูุฌุบุฑุงููุง ูุงูุนูุงุตู\n๐ฌ ุงูุนููู ูุงูุชูููููุฌูุง\n๐ ุงูุชุงุฑูุฎ ูุงูุญุถุงุฑุงุช\n๐โโ๏ธ ุงูุฑูุงุถุฉ\n๐ญ ุงูุซูุงูุฉ ูุงูุฃุฏุจ\n๐ฝ๏ธ ุงูุทุนุงู ูุงููุทุจุฎ\n๐ฅ ุงูุตุญุฉ ูุงูุทุจ\n๐ผ ุงูุงูุชุตุงุฏ ูุงููุงู\n๐พ ุงูุญููุงูุงุช ูุงูุทุจูุนุฉ\n๐ ุงููุถุงุก ูุงูููุงูุจ\n\nุงุณุฃู ุฃู ุณุคุงู ูุณุฃุฌูุจู!";
          await sendMessage(senderId, welcomeText, PAGE_ACCESS_TOKEN);
        }
      }
      return { statusCode: 200, body: "EVENT_RECEIVED" };
    }
    return { statusCode: 404, body: "Not Found" };
  }

  return { statusCode: 405, body: "Method Not Allowed" };
}

// ๐ง ุฏุงูุฉ ุชูููุฏ ุงูุฑุฏูุฏ ุงูุฏููุงููููุฉ
function generateDynamicResponse(userMsg) {
  const msg = userMsg.toLowerCase().trim();

  // ุฃููุงุท ุงูุฃุณุฆูุฉ ุงููุฎุชููุฉ
  const patterns = {
    // ุงูุนูุงุตู ูุงูุฌุบุฑุงููุง
    capitals: {
      keywords: ['ุนุงุตูุฉ', 'ุนุงุตูู'],
      handler: handleCapitalQuestions
    },
    
    // ุงูุนููู
    science: {
      keywords: ['ูุฎุชุฑุน', 'ููุชุดู', 'ุนุงูู', 'ุงุฎุชุฑุงุน', 'ุงูุชุดุงู'],
      handler: handleScienceQuestions
    },
    
    // ุงูุชุงุฑูุฎ
    history: {
      keywords: ['ูุชู', 'ุชุงุฑูุฎ', 'ุญุฏุซ', 'ุญุฑุจ', 'ูุนุฑูุฉ', 'ุณูุฉ'],
      handler: handleHistoryQuestions
    },
    
    // ุงูุฑูุงุถุฉ
    sports: {
      keywords: ['ุฑูุงุถุฉ', 'ูุฃุณ', 'ุจุทููุฉ', 'ุฃูููุจูุงุฏ', 'ูุฑูู', 'ูุงุนุจ'],
      handler: handleSportsQuestions
    },
    
    // ุงูุทุจ ูุงูุตุญุฉ
    health: {
      keywords: ['ุตุญุฉ', 'ุทุจ', 'ูุฑุถ', 'ุนูุงุฌ', 'ุฏูุงุก', 'ุทุจูุจ'],
      handler: handleHealthQuestions
    },
    
    // ุงูุญููุงูุงุช
    animals: {
      keywords: ['ุญููุงู', 'ุญููุงูุงุช', 'ุทุงุฆุฑ', 'ุณูู', 'ูุจุงุช'],
      handler: handleAnimalQuestions
    },
    
    // ุงูุฃุฑูุงู ูุงูุฅุญุตุงุฆูุงุช
    numbers: {
      keywords: ['ูู ุนุฏุฏ', 'ูู', 'ุนุฏุฏ', 'ูููุฉ', 'ููุฏุงุฑ'],
      handler: handleNumberQuestions
    },
    
    // ุงูุฃููุงู ูุงูุฃุดูุงู
    colors: {
      keywords: ['ููู', 'ุฃุญูุฑ', 'ุฃุฒุฑู', 'ุฃุฎุถุฑ', 'ุฃุตูุฑ', 'ุฃุณูุฏ', 'ุฃุจูุถ'],
      handler: handleColorQuestions
    },
    
    // ุงูุทุนุงู
    food: {
      keywords: ['ุทุนุงู', 'ุฃูู', 'ูุทุจุฎ', 'ูุตูุฉ', 'ุทุจู', 'ูุงููุฉ', 'ุฎุถุงุฑ'],
      handler: handleFoodQuestions
    },
    
    // ุงูุชูููููุฌูุง
    technology: {
      keywords: ['ุชูููุฉ', 'ุชูููููุฌูุง', 'ููุจููุชุฑ', 'ูุงุชู', 'ุงูุชุฑูุช', 'ุชุทุจูู'],
      handler: handleTechnologyQuestions
    }
  };

  // ุงูุจุญุซ ุนู ุงูููุท ุงูููุงุณุจ
  for (const [category, pattern] of Object.entries(patterns)) {
    if (pattern.keywords.some(keyword => msg.includes(keyword))) {
      return pattern.handler(msg);
    }
  }

  // ุฃุณุฆูุฉ ุดุงุฆุนุฉ ูุจุงุดุฑุฉ
  const directAnswers = getDirectAnswers();
  for (const [question, answer] of Object.entries(directAnswers)) {
    if (msg.includes(question) || question.includes(msg)) {
      return answer;
    }
  }

  // ุฅุฐุง ูู ูุชู ุงูุนุซูุฑ ุนูู ุชุทุงุจู
  return generateGenericResponse(msg);
}

// ูุนุงูุฌ ุฃุณุฆูุฉ ุงูุนูุงุตู
function handleCapitalQuestions(msg) {
  const countries = {
    'ูุตุฑ': 'ุงููุงูุฑุฉ',
    'ุงูุณุนูุฏูุฉ': 'ุงูุฑูุงุถ',
    'ุงูุฅูุงุฑุงุช': 'ุฃุจู ุธุจู',
    'ูุฑูุณุง': 'ุจุงุฑูุณ',
    'ุฃููุงููุง': 'ุจุฑููู',
    'ุงููุงุจุงู': 'ุทูููู',
    'ุงูุตูู': 'ุจููู',
    'ุฃูุฑููุง': 'ูุงุดูุทู',
    'ุฑูุณูุง': 'ููุณูู',
    'ุงููุบุฑุจ': 'ุงูุฑุจุงุท',
    'ุงูุฌุฒุงุฆุฑ': 'ุงูุฌุฒุงุฆุฑ',
    'ุชููุณ': 'ุชููุณ',
    'ุงูุฃุฑุฏู': 'ุนูุงู',
    'ูุจูุงู': 'ุจูุฑูุช',
    'ุณูุฑูุง': 'ุฏูุดู',
    'ุงูุนุฑุงู': 'ุจุบุฏุงุฏ',
    'ุงููููุช': 'ุงููููุช',
    'ูุทุฑ': 'ุงูุฏูุญุฉ',
    'ุงูุจุญุฑูู': 'ุงูููุงูุฉ',
    'ุนูุงู': 'ูุณูุท',
    'ุงูููู': 'ุตูุนุงุก',
    'ุงูุณูุฏุงู': 'ุงูุฎุฑุทูู',
    'ููุจูุง': 'ุทุฑุงุจูุณ',
    'ุฅูุทุงููุง': 'ุฑููุง',
    'ุฅุณุจุงููุง': 'ูุฏุฑูุฏ',
    'ุงูููููุฉ ุงููุชุญุฏุฉ': 'ููุฏู',
    'ููุฏุง': 'ุฃูุชุงูุง',
    'ุฃุณุชุฑุงููุง': 'ูุงูุจุฑุง',
    'ุงูุจุฑุงุฒูู': 'ุจุฑุงุฒูููุง',
    'ุงูููุฏ': 'ููู ุฏููู',
    'ุชุฑููุง': 'ุฃููุฑุฉ',
    'ุฅูุฑุงู': 'ุทูุฑุงู'
  };

  for (const [country, capital] of Object.entries(countries)) {
    if (msg.includes(country)) {
      return `ุนุงุตูุฉ ${country} ูู ${capital}.`;
    }
  }
  
  return "ูุฑุฌู ุชุญุฏูุฏ ุงูุฏููุฉ ุงูุชู ุชุฑูุฏ ูุนุฑูุฉ ุนุงุตูุชูุง.";
}

// ูุนุงูุฌ ุฃุณุฆูุฉ ุงูุนููู
function handleScienceQuestions(msg) {
  const scienceAnswers = {
    'ุงูุฌุงุฐุจูุฉ': 'ููุชุดู ุงูุฌุงุฐุจูุฉ ูู ุฅุณุญุงู ูููุชู.',
    'ุงูุจูุณููู': 'ููุชุดู ุงูุจูุณููู ูู ุฃููุณูุฏุฑ ูููููุบ.',
    'ุงููุงุชู': 'ูุฎุชุฑุน ุงููุงุชู ูู ุฃููุณูุฏุฑ ุบุฑุงูุงู ุจูู.',
    'ุงููุตุจุงุญ': 'ูุฎุชุฑุน ุงููุตุจุงุญ ุงูููุฑุจุงุฆู ูู ุชููุงุณ ุฃุฏูุณูู.',
    'ุงูุฑุงุฏูู': 'ูุฎุชุฑุน ุงูุฑุงุฏูู ูู ูุงุฑูููู.',
    'ุงูุชููุฒููู': 'ูุฎุชุฑุน ุงูุชููุฒููู ูู ุฌูู ููุฌู ุจูุฑุฏ.',
    'ุงููุณุจูุฉ': 'ูุธุฑูุฉ ุงููุณุจูุฉ ูุถุนูุง ุฃูุจุฑุช ุฃููุดุชุงูู.',
    'ุงูุชุทูุฑ': 'ูุธุฑูุฉ ุงูุชุทูุฑ ูุถุนูุง ุชุดุงุฑูุฒ ุฏุงุฑููู.',
    'ุงูููุฑุจุงุก': 'ุจูุฌุงููู ูุฑุงููููู ูุงู ูู ุฑูุงุฏ ุงูุชุดุงู ุงูููุฑุจุงุก.',
    'ุงูุทูุฑุงู': 'ุงูุฃุฎูุงู ุฑุงูุช ููุง ุฃูู ูู ุทุงุฑ ุจุทุงุฆุฑุฉ.'
  };

  for (const [topic, answer] of Object.entries(scienceAnswers)) {
    if (msg.includes(topic)) {
      return answer;
    }
  }

  return "ุฃุฑุฌู ุชุญุฏูุฏ ุงูุงุฎุชุฑุงุน ุฃู ุงูุงูุชุดุงู ุงูุนููู ุงูุฐู ุชุฑูุฏ ูุนุฑูุฉ ุงููุฒูุฏ ุนูู.";
}

// ูุนุงูุฌ ุฃุณุฆูุฉ ุงูุชุงุฑูุฎ
function handleHistoryQuestions(msg) {
  if (msg.includes('ุงูุญุฑุจ ุงูุนุงูููุฉ ุงูุฃููู')) {
    return 'ุงูุญุฑุจ ุงูุนุงูููุฉ ุงูุฃููู ุญุฏุซุช ูู 1914 ุฅูู 1918.';
  }
  if (msg.includes('ุงูุญุฑุจ ุงูุนุงูููุฉ ุงูุซุงููุฉ')) {
    return 'ุงูุญุฑุจ ุงูุนุงูููุฉ ุงูุซุงููุฉ ุญุฏุซุช ูู 1939 ุฅูู 1945.';
  }
  if (msg.includes('ูุชุญ ููุฉ')) {
    return 'ูุชุญ ููุฉ ูุงู ูู ุงูุณูุฉ ุงูุซุงููุฉ ูููุฌุฑุฉ (629-630 ู).';
  }
  if (msg.includes('ูุนุฑูุฉ ุงููุฑููู')) {
    return 'ูุนุฑูุฉ ุงููุฑููู ุญุฏุซุช ุนุงู 636 ู ุจูู ุงููุณูููู ูุงูุจูุฒูุทููู.';
  }
  if (msg.includes('ุณููุท ุงูุฃูุฏูุณ')) {
    return 'ุณููุท ุงูุฃูุฏูุณ ุญุฏุซ ุนุงู 1492 ู ูุน ุณููุท ุบุฑูุงุทุฉ.';
  }

  return "ูุฑุฌู ุชุญุฏูุฏ ุงูุญุฏุซ ุงูุชุงุฑูุฎู ุงูุฐู ุชุฑูุฏ ูุนุฑูุฉ ุชุงุฑูุฎู.";
}

// ูุนุงูุฌ ุฃุณุฆูุฉ ุงูุฑูุงุถุฉ
function handleSportsQuestions(msg) {
  const sportsAnswers = {
    'ูุฃุณ ุงูุนุงูู': 'ูุฃุณ ุงูุนุงูู ููุฑุฉ ุงููุฏู ุชูุงู ูู 4 ุณููุงุช ูุชูุธููุง ุงููููุง.',
    'ุงูุฃูููุจูุงุฏ': 'ุงูุฃูุนุงุจ ุงูุฃูููุจูุฉ ุชูุงู ูู 4 ุณููุงุช ุตููุงู ูุดุชุงุกู.',
    'ุฑูุงู ูุฏุฑูุฏ': 'ุฑูุงู ูุฏุฑูุฏ ูุงุฏู ุฅุณุจุงูู ูู ูุฏุฑูุฏุ ุงูุฃูุซุฑ ููุฒุงู ุจุฏูุฑู ุฃุจุทุงู ุฃูุฑูุจุง.',
    'ุจุฑุดูููุฉ': 'ุจุฑุดูููุฉ ูุงุฏู ุฅุณุจุงูู ูู ูุงุชุงููููุงุ ูุดููุฑ ุจุฃุณููุจ ุงููุนุจ ุงูุฌููู.',
    'ูุญูุฏ ุตูุงุญ': 'ูุญูุฏ ุตูุงุญ ูุงุนุจ ูุตุฑู ููุนุจ ูู ูููุฑุจูู ุงูุฅูุฌููุฒู.',
    'ุงูุฃููู': 'ุงูุฃููู ูู ุฃูุซุฑ ุงูุฃูุฏูุฉ ููุฒุงู ูู ูุตุฑ ูุงููุงุฑุฉ ุงูุฃูุฑูููุฉ.',
    'ุงูุฒูุงูู': 'ุงูุฒูุงูู ูุงุฏู ูุตุฑู ุนุฑูู ููู ุฃููู ุฃูุฏูุฉ ุฃูุฑูููุง.'
  };

  for (const [topic, answer] of Object.entries(sportsAnswers)) {
    if (msg.includes(topic)) {
      return answer;
    }
  }

  return "ุฃุฎุจุฑูู ุนู ุฃู ูุฑูู ุฃู ุจุทููุฉ ุฑูุงุถูุฉ ุชุฑูุฏ ูุนุฑูุฉ ุงููุฒูุฏ ุนููุง.";
}

// ูุนุงูุฌ ุฃุณุฆูุฉ ุงูุตุญุฉ
function handleHealthQuestions(msg) {
  const healthTips = [
    "ุดุฑุจ 8 ุฃููุงุจ ูู ุงููุงุก ููููุงู ููู ููุตุญุฉ.",
    "ููุงุฑุณุฉ ุงูุฑูุงุถุฉ 30 ุฏูููุฉ ููููุงู ุชุญุณู ุงูุตุญุฉ ุงูุนุงูุฉ.",
    "ุชูุงูู 5 ุญุตุต ูู ุงูููุงูู ูุงูุฎุถุฑูุงุช ููููุงู ูููุฏ ุฌุฏุงู.",
    "ุงูููู 7-8 ุณุงุนุงุช ูููุงู ุถุฑูุฑู ูุตุญุฉ ุงูุฌุณู ูุงูุนูู.",
    "ุชุฌูุจ ุงูุชุฏุฎูู ูุงููุญูู ูุญุณู ุงูุตุญุฉ ุจุดูู ูุจูุฑ.",
    "ุบุณู ุงููุฏูู ุจุงูุชุธุงู ูููุน ุงูุชุดุงุฑ ุงูุฃูุฑุงุถ.",
    "ุงููุญุต ุงูุทุจู ุงูุฏูุฑู ููู ูููุดู ุงููุจูุฑ ุนู ุงูุฃูุฑุงุถ."
  ];

  return healthTips[Math.floor(Math.random() * healthTips.length)];
}

// ูุนุงูุฌ ุฃุณุฆูุฉ ุงูุญููุงูุงุช
function handleAnimalQuestions(msg) {
  const animalFacts = {
    'ุงูููู': 'ุงูููู ุฃูุจุฑ ุญููุงู ุจุฑู ูู ุงูุนุงููุ ููููู ุฃู ูุฒู ุญุชู 6 ุฃุทูุงู.',
    'ุงูุฃุณุฏ': 'ุงูุฃุณุฏ ูุณูู ููู ุงูุบุงุจุฉ ููุนูุด ูู ุฃูุฑูููุง ูุขุณูุง.',
    'ุงูููุฑ': 'ุงูููุฑ ุฃูุจุฑ ุงููุทุท ุงูุจุฑูุฉ ููููู ุฃู ูููุฒ 9 ุฃูุชุงุฑ.',
    'ุงูููุฏ': 'ุงูููุฏ ุฃุณุฑุน ุญููุงู ุจุฑู ุจุณุฑุนุฉ ุชุตู ุฅูู 120 ูู/ุณุงุนุฉ.',
    'ุงูุฒุฑุงูุฉ': 'ุงูุฒุฑุงูุฉ ุฃุทูู ุญููุงู ูู ุงูุนุงูู ุจุงุฑุชูุงุน ูุตู ุฅูู 5.5 ูุชุฑ.',
    'ุงูุญูุช': 'ุงูุญูุช ุงูุฃุฒุฑู ุฃูุจุฑ ุญููุงู ูู ุงูุนุงูู.',
    'ุงููุณุฑ': 'ุงููุณุฑ ูู ุงูุทููุฑ ุงูุฌุงุฑุญุฉ ูููููู ุงูุทูุฑุงู ุนูู ุงุฑุชูุงุนุงุช ุนุงููุฉ.',
    'ุงูุจุทุฑูู': 'ุงูุจุทุฑูู ุทุงุฆุฑ ูุง ูุทูุฑ ูููู ุณุจุงุญ ูุงูุฑ.'
  };

  for (const [animal, fact] of Object.entries(animalFacts)) {
    if (msg.includes(animal)) {
      return fact;
    }
  }

  return "ุฃุฎุจุฑูู ุนู ุฃู ุญููุงู ุชุฑูุฏ ูุนุฑูุฉ ุญูุงุฆู ูุซูุฑุฉ ุนูู.";
}

// ูุนุงูุฌ ุงูุฃุณุฆูุฉ ุงูุฑูููุฉ
function handleNumberQuestions(msg) {
  const numberAnswers = {
    'ูู ุนุฏุฏ ุฃุณูุงู ุงูุฅูุณุงู': 'ุงูุฅูุณุงู ุงูุจุงูุบ ูุฏูู 32 ุณู.',
    'ูู ุนุฏุฏ ุนุธุงู ุงูุฅูุณุงู': 'ุงูุฅูุณุงู ุงูุจุงูุบ ูุฏูู 206 ุนุธูุฉ.',
    'ูู ุนุฏุฏ ุฏูู ุงูุนุงูู': 'ููุฌุฏ 195 ุฏููุฉ ูุนุชุฑู ุจูุง ูู ุงูุนุงูู.',
    'ูู ุนุฏุฏ ูุงุฑุงุช ุงูุนุงูู': 'ููุฌุฏ 7 ูุงุฑุงุช ูู ุงูุนุงูู.',
    'ูู ุนุฏุฏ ุงููุญูุทุงุช': 'ููุฌุฏ 5 ูุญูุทุงุช ูู ุงูุนุงูู.',
    'ูู ุนุฏุฏ ุฃูุงู ุงูุณูุฉ': 'ุงูุณูุฉ ุงูุนุงุฏูุฉ 365 ููู ูุงููุจูุณุฉ 366 ููู.',
    'ูู ุนุฏุฏ ุณุงุนุงุช ุงูููู': 'ุงูููู ุงููุงุญุฏ 24 ุณุงุนุฉ.',
    'ูู ุนุฏุฏ ุฏูุงุฆู ุงูุณุงุนุฉ': 'ุงูุณุงุนุฉ ุงููุงุญุฏุฉ 60 ุฏูููุฉ.'
  };

  for (const [question, answer] of Object.entries(numberAnswers)) {
    if (msg.includes(question.substring(0, 15))) {
      return answer;
    }
  }

  return "ุฃุฎุจุฑูู ุจุงูุถุจุท ูุง ุชุฑูุฏ ูุนุฑูุฉ ุนุฏุฏู.";
}

// ูุนุงูุฌ ุฃุณุฆูุฉ ุงูุฃููุงู
function handleColorQuestions(msg) {
  if (msg.includes('ุฃููุงู ููุณ ูุฒุญ')) {
    return 'ุฃููุงู ููุณ ูุฒุญ ูู: ุฃุญูุฑุ ุจุฑุชูุงููุ ุฃุตูุฑุ ุฃุฎุถุฑุ ุฃุฒุฑูุ ููููุ ุจููุณุฌู.';
  }
  if (msg.includes('ููู ุงูุฏู')) {
    return 'ููู ุงูุฏู ุฃุญูุฑ ุจุณุจุจ ุงูููููุฌููุจูู.';
  }
  if (msg.includes('ููู ุงูุณูุงุก')) {
    return 'ููู ุงูุณูุงุก ุฃุฒุฑู ุจุณุจุจ ุชุดุชุช ุถูุก ุงูุดูุณ ูู ุงูุบูุงู ุงูุฌูู.';
  }
  return "ุฃุฎุจุฑูู ุนู ุฃู ููู ุชุฑูุฏ ูุนุฑูุฉ ุงููุฒูุฏ ุนูู.";
}

// ูุนุงูุฌ ุฃุณุฆูุฉ ุงูุทุนุงู
function handleFoodQuestions(msg) {
  const foodFacts = {
    'ุงูุจูุชุฒุง': 'ุงูุจูุชุฒุง ุทุจู ุฅูุทุงูู ุดููุฑ ุงูุชุดุฑ ูู ุงูุนุงูู.',
    'ุงูุณูุดู': 'ุงูุณูุดู ุทุจู ูุงุจุงูู ุชูููุฏู ูู ุงูุณูู ูุงูุฃุฑุฒ.',
    'ุงููุจุณุฉ': 'ุงููุจุณุฉ ุทุจู ุดุนุจู ุฎููุฌู ูุน ุงูุฃุฑุฒ ูุงููุญู.',
    'ุงูููุณู': 'ุงูููุณู ุงูุทุจู ุงูุดุนุจู ุงูุฃุฑุฏูู ูุน ุงููุญู ูุงููุจู.',
    'ุงููุดุฑู': 'ุงููุดุฑู ุทุจู ูุตุฑู ุดุนุจู ูู ุงูุฃุฑุฒ ูุงูุนุฏุณ ูุงูููุฑููุฉ.',
    'ุงูุชุจููุฉ': 'ุงูุชุจููุฉ ุณูุทุฉ ูุจูุงููุฉ ูู ุงูุจุฑุบู ูุงูุฎุถุฑูุงุช.',
    'ุงูุญูุต': 'ุงูุญูุต ุทุจู ุดุฑู ุฃูุณุทู ูุบุฐู ููุฐูุฐ.'
  };

  for (const [food, info] of Object.entries(foodFacts)) {
    if (msg.includes(food)) {
      return info;
    }
  }

  return "ุฃุฎุจุฑูู ุนู ุฃู ุทุจู ุฃู ุทุนุงู ุชุฑูุฏ ูุนุฑูุฉ ูุนูููุงุช ุนูู.";
}

// ูุนุงูุฌ ุฃุณุฆูุฉ ุงูุชูููููุฌูุง
function handleTechnologyQuestions(msg) {
  const techAnswers = {
    'ุงูุฐูุงุก ุงูุงุตุทูุงุนู': 'ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุชูููุฉ ุชููู ุงูุขูุงุช ูู ูุญุงูุงุฉ ุงูุฐูุงุก ุงูุจุดุฑู.',
    'ุงูุจููู ุชุดูู': 'ุงูุจููู ุชุดูู ุชูููุฉ ูุญูุธ ุงูุจูุงูุงุช ุจุทุฑููุฉ ุขููุฉ ูููุฒุนุฉ.',
    'ุงููุงูุน ุงูุงูุชุฑุงุถู': 'ุงููุงูุน ุงูุงูุชุฑุงุถู ุชูููุฉ ุชุฎูู ุจูุฆุฉ ุฑูููุฉ ุชูุงุนููุฉ.',
    'ุงููุงูุน ุงููุนุฒุฒ': 'ุงููุงูุน ุงููุนุฒุฒ ูุฏูุฌ ุงูุนุงูู ุงูุฑููู ูุน ุงูุญูููู.',
    'ุฅูุชุฑูุช ุงูุฃุดูุงุก': 'ุฅูุชุฑูุช ุงูุฃุดูุงุก ูุฑุจุท ุงูุฃุฌูุฒุฉ ุงููุฎุชููุฉ ุจุงูุฅูุชุฑูุช.',
    'ุงูุญูุณุจุฉ ุงูุณุญุงุจูุฉ': 'ุงูุญูุณุจุฉ ุงูุณุญุงุจูุฉ ุชููุฑ ุงูุฎุฏูุงุช ุงูุชูููุฉ ุนุจุฑ ุงูุฅูุชุฑูุช.'
  };

  for (const [tech, explanation] of Object.entries(techAnswers)) {
    if (msg.includes(tech)) {
      return explanation;
    }
  }

  return "ุฃุฎุจุฑูู ุนู ุฃู ุชูููุฉ ุชุฑูุฏ ูุนุฑูุฉ ุงููุฒูุฏ ุนููุง.";
}

// ุฅุฌุงุจุงุช ูุจุงุดุฑุฉ ููุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ
function getDirectAnswers() {
  return {
    'ูุฑุญุจุง': 'ูุฑุญุจุงู ุจู! ููู ูููููู ูุณุงุนุฏุชู ุงููููุ',
    'ุงูุณูุงู ุนูููู': 'ูุนูููู ุงูุณูุงู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชู. ุฃููุงู ุจู!',
    'ุดูุฑุง': 'ุงูุนูู! ุณุนูุฏ ุจูุณุงุนุฏุชู.',
    'ููู ุงูุญุงู': 'ุงูุญูุฏ ูููุ ุฃูุง ุจุฎูุฑ. ููู ูููููู ูุณุงุนุฏุชูุ',
    'ูุง ุงุณูู': 'ุฃูุง ูุณุงุนุฏ ุฐููุ ููููู ููุงุฏุงุชู ุจุฃู ุงุณู ุชุญุจ.',
    'ูู ุฃูุช': 'ุฃูุง ูุณุงุนุฏ ุฐูู ูุตูู ููุฅุฌุงุจุฉ ุนูู ุฃุณุฆูุชู ุงููุฎุชููุฉ.',
    'ูุง ูู ุนููู': 'ุนููู ูู ูุณุงุนุฏุชู ูู ุงูุญุตูู ุนูู ุงููุนูููุงุช ุงูุชู ุชุญุชุงุฌูุง.',
    'ูู ุชุชููู ุนุฑุจู': 'ูุนูุ ุฃุชููู ุงูุนุฑุจูุฉ ูุฃุณุนุฏ ุจุงูุชุญุฏุซ ูุนู ุจูุง.',
    'ุฃูู ุชุนูุด': 'ุฃูุง ููุฌูุฏ ูู ุงูุนุงูู ุงูุฑููู ููุณุงุนุฏุชู ุฃูููุง ููุช.',
    'ูู ุนูุฑู': 'ุฃูุง ุจุฑูุงูุฌ ุฐููุ ูุนูุฑู ููุงุณ ุจุงูุชุญุฏูุซุงุช ูููุณ ุจุงูุณููุงุช.'
  };
}

// ุชูููุฏ ุฑุฏ ุนุงู
function generateGenericResponse(msg) {
  const genericResponses = [
    "ุณุคุงู ููุชุงุฒ! ุฏุนูู ุฃุจุญุซ ูู ุนู ุฅุฌุงุจุฉ ูููุฏุฉ.",
    "ุฃุนุชุฐุฑุ ูุง ุฃููู ูุนูููุงุช ุฏูููุฉ ุญูู ูุฐุง ุงูููุถูุน ุญุงููุงู.",
    "ููููู ุฅุนุงุฏุฉ ุตูุงุบุฉ ุณุคุงูู ุฃู ุณุคุงูู ุนู ููุถูุน ุขุฎุฑ.",
    "ูุฐุง ููุถูุน ูุซูุฑ ููุงูุชูุงู! ููู ูุฏ ุชุญุชุงุฌ ููุตุงุฏุฑ ูุชุฎุตุตุฉ ููุญุตูู ุนูู ุฅุฌุงุจุฉ ุฏูููุฉ.",
    "ุฃูุฏุฑ ุณุคุงููุ ูููู ูุฏ ูููู ูู ุงูุฃูุถู ุงุณุชุดุงุฑุฉ ุฎุจูุฑ ูู ูุฐุง ุงููุฌุงู.",
    "ุณุคุงู ุฑุงุฆุน! ููููู ุณุคุงูู ุนู ุงูุฌุบุฑุงููุง ูุงูุนููู ูุงูุชุงุฑูุฎ ูุงูุฑูุงุถุฉ ูุงูุตุญุฉ."
  ];

  return genericResponses[Math.floor(Math.random() * genericResponses.length)];
}

// ๐น ุฏุงูุฉ ูุฅุฑุณุงู ุฑุณุงูุฉ ูุตูุฉ
async function sendMessage(senderId, text, token) {
  await fetch(`https://graph.facebook.com/v16.0/me/messages?access_token=${token}`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      recipient: { id: senderId },
      message: { text },
    }),
  });
}